{
  "module": "cli",
  "description": "CLI commands and argument parsing",
  "status": "in_progress",
  "components": {
    "phase_commands_wiring": {
      "status": "complete",
      "implementation": "PhaseCommands.cs wired to IWorkflowOrchestrator with prompt injection",
      "tests": "PhaseCommandTests (including orchestrator wiring, prompt passing, exit codes)",
      "jobs": [
        "JOB-004",
        "JOB-005",
        "JOB-006"
      ],
      "notes": "spec/plan/build commands invoke WorkflowOrchestrator.RunAsync with prompt when session and module are available."
    },
    "root_tui_wiring": {
      "status": "complete",
      "implementation": "Program.cs calls UseRealTui(). RootCommandHandler resolves ITuiApplication.",
      "tests": "RootCommandTests (existing tests), TuiApplicationTests (UseRealTui DI tests)",
      "jobs": [
        "JOB-077"
      ],
      "notes": "UseRealTui replaces stub with TuiApplication for real CLI. Tests/headless use stub."
    },
    "prompt_injection": {
      "status": "complete",
      "implementation": "--prompt flag wired through IWorkflowOrchestrator to IPromptBuilder contextSections, and to ITuiApplication.RunAsync for TUI pre-population",
      "tests": "Spec_WithPrompt_PassesPromptToOrchestrator, RootCommand_WithPrompt_PassesPromptToTui, StubTuiApplication prompt tests",
      "jobs": [
        "JOB-031",
        "JOB-032"
      ],
      "notes": "Headless: prompt injected via contextSections[user_prompt]. TUI: prompt passed as initialPrompt parameter."
    },
    "headless_validation": {
      "status": "complete",
      "implementation": "ValidateHeadlessPromptAsync checks headless mode requires --prompt or active session",
      "tests": "Headless_NoPrompt_NoSession_ReturnsExitCode1",
      "jobs": [
        "JOB-033"
      ],
      "notes": "Returns ExitCodes.Failure with guidance message."
    },
    "exit_codes": {
      "status": "complete",
      "implementation": "ExitCodes.Success=0, Failure=1, UserInterventionRequired=2. WasInterrupted in headless returns code 2.",
      "tests": "ExitCodes_AreCorrect, headless interrupt paths",
      "jobs": [
        "JOB-034"
      ],
      "notes": "Phase commands and RootCommandHandler both return code 2 when headless + WasInterrupted."
    },
    "quiet_flag": {
      "status": "complete",
      "implementation": "GlobalOptions --headless/-q/--quiet, HeadlessRenderer, RootCommandHandler headless path, PhaseCommands headless validation",
      "tests": "GlobalOptionsTests (alias verification), RootCommandTests (headless paths), PhaseCommandTests (headless validation), HeadlessRendererTests, CliIntegrationTests",
      "jobs": [
        "JOB-078"
      ],
      "notes": "Already fully implemented prior to JOB-078 being tracked."
    },
    "project_root_discovery": {
      "status": "complete",
      "implementation": "ProjectRootDiscovery.FindProjectRoot walks up from CWD looking for .lopen/ then .git/. Program.cs passes result to AddLopenCore and AddLopenStorage.",
      "tests": "ProjectRootDiscoveryTests (9 tests: .lopen/ found, .git/ found, .lopen/ priority, no markers, walk up, current dir, same dir both, git fallback, null chain)",
      "jobs": [
        "JOB-001"
      ],
      "notes": "Enables all path-dependent services (git, sessions, plans, caches, modules, workflow) to register at startup."
    }
  },
  "last_updated": "2026-02-17T03:55:00Z"
}
